/*!
 * @mk816017/form-builder v1.1.1 | MIT License | git+https://github.com/zhongyoulu/vue-sfc-rollup-demo.git
 * https://unpkg.com/@mk816017/form-builder@1.1.1/dist/form-builder.min.js
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("vue-select"),require("fuse.js"),require("@popperjs/core"),require("@iconify/iconify"),require("vuedraggable")):"function"==typeof define&&define.amd?define(["vue-select","fuse.js","@popperjs/core","@iconify/iconify","vuedraggable"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).FormXXXBuilder=t(e.VueSelect,e.Fuse,e.Popper,e.Iconify,e.vuedraggable)}(this,(function(e,t,n,i,r){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=o(e),u=o(t),l=o(i),s=o(r);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t,n,i,r,o,a){try{var u=e[o](a),l=u.value}catch(e){return void n(e)}u.done?t(l):Promise.resolve(l).then(i,r)}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(i=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(r)throw o}}return n}(e,t)||b(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var _=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21,t="",n=crypto.getRandomValues(new Uint8Array(e));e--;){var i=63&n[e];t+=i<36?i.toString(36):i<62?(i-26).toString(36).toUpperCase():i<63?"_":"-"}return t},C=function e(t){return t&&"object"===c(t)?t instanceof Date?new Date(t.getTime()):t instanceof Array?t.reduce((function(t,n,i){return t[i]=e(n),t}),[]):t instanceof Object?Object.keys(t).reduce((function(n,i){return n[i]=e(t[i]),n}),{}):void 0:t},x=function(e,t){return Object.entries(e).reduce((function(e,n){var i=h(n,2),r=i[0],o=i[1];return m(m({},e),{},p({},r,o[t]))}),{})};function S(e){if(null==e)return!0;if("number"==typeof e)return!1;if(e.length>0)return!1;if(0===e.length)return!0;if("object"!==c(e))return!0;for(var t in e)if(hasOwnProperty.call(e,t))return!1;return!0}function k(e){return Object.entries(e).forEach((function(t){var n=h(t,2),i=n[0],r=n[1];return r&&"object"===c(r)&&k(r)||r&&r instanceof File||(null==r||""===r)&&delete e[i]})),S(e)?null:e}function O(e,t,n){if(!Array.isArray(e))return e;var i=e.findIndex((function(e){return e[t]===n}));return function(e,t){if(-1===t)return e;var n=e.length;return 0===t?e.slice(1):t===n-1?e.slice(0,n-1):[].concat(y(e.slice(0,t)),y(e.slice(t+1)))}(e,i)}function I(e,t,n,i){if(!Array.isArray(e))return e;var r=e.findIndex((function(e){return e[t]===n}));return r>=0?[].concat(y(e.slice(0,r)),[m(m({},e[r]),i)],y(e.slice(r+1))):e}var $=function(e,t){return e.filter((function(e){return!t.includes(e)}))};function w(e,t,n,i,r,o,a,u,l,s){"boolean"!=typeof a&&(l=u,u=a,a=!1);const c="function"==typeof n?n.options:n;let d;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,r&&(c.functional=!0)),i&&(c._scopeId=i),o?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=d):t&&(d=a?function(e){t.call(this,s(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,u(e))}),d)if(c.functional){const e=c.render;c.render=function(t,n){return d.call(n),e(t,n)}}else{const e=c.beforeCreate;c.beforeCreate=e?[].concat(e,d):[d]}return n}var A={name:"FormMainLogic",provide:function(){return{collect:this.collect,setCollect:this.setCollect,toggleCollect:this.toggleCollect,typeOptions:this.typeOptions,typeIcons:this.typeIcons,getTypeConstraint:this.getTypeConstraint,convertOptions:this.convertOptions}},inject:["handleConfirm"],props:{columns:{type:Array,required:!0}},emits:["update:columns"],data:function(){return{collect:{}}},computed:{finalColumns:function(){return this.columns.map((function(e){return Object.entries(e).reduce((function(e,t){var n=h(t,2),i=n[0],r=n[1];if(S(r))return e;if("rule"===i){var o=r,a=o.msg,u=v(o,["msg"]);if(a){var l=Object.entries(a).reduce((function(e,t){var n=h(t,2),i=n[0],r=n[1];return r&&u[i]&&(e[i]=r),e}),{});S(l)||(u.msg=l)}r=u}else if("data"===i){var s=r,c=s.items,d=s.api,p=v(s,["items","api"]);switch(p.srcMode){case"api":p.api=d;break;case"list":p.items=c}r=p}else"condition"===i&&console.log(i,r);return S(r)||(e[i]=r),e}),{})}))},typeConfig:function(){return{text:{text:"文字框",icon:"carbon:string-text"},number:{text:"數字框",icon:"carbon:string-integer"},date:{text:"日期框",icon:"carbon:calendar"},radio:{text:"單選框",icon:"carbon:radio-button-checked"},checkbox:{text:"複選框",icon:"carbon:checkbox-checked"},select:{text:"下拉選單",icon:"carbon:list"},file:{text:"檔案",icon:"ic:baseline-attach-file"}}},typeOptions:function(){return this.convertOptions(x(this.typeConfig,"text"))},typeIcons:function(){return m(m({},x(this.typeConfig,"icon")),{},{undefined:"carbon:unknown"})}},watch:{columns:function(e,t){var n=this,i=$(e.map((function(e){return e.id})),Object.keys(this.collect));i.length&&i.map((function(e){n.$set(n.collect,e,{})}));var r=$(t.map((function(e){return e.id})),e.map((function(e){return e.id})));r.length&&e.forEach((function(e){var t,n;e.rule&&r.includes(e.rule.sameAs)&&(e.rule.sameAs=null),e.condition&&(e.condition.requiredSync=(t=e.condition.requiredSync,n=r,Array.isArray(t)?t.filter((function(e){return!n.includes(e)})):t),e.condition.display=function(e,t,n){return Array.isArray(e)?e.filter((function(e){return!n.includes(e[t])})):e}(e.condition.display,"triggerID",r))}))}},methods:{convertOptions:function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id";return Object.entries(e).reduce((function(e,i){var r,o=h(i,2),a=o[0],u=o[1];return e.concat((p(r={},n,a),p(r,t,u),r))}),[])}(e,"text","value")},getTypeConstraint:function(e){return{isText:"text"===e,isNumber:"number"===e,isDate:"date"===e,isCheckbox:"checkbox"===e,isFile:"file"===e,isInput:["text","number","date"].includes(e),needItems:["select","radio","checkbox"].includes(e),filterSame:function(t){return t.filter((function(t){return t.type===e}))}}},emitUpdate:function(e,t){console.log("".concat(t&&"[".concat(t,"] "),"update:columns"),e);var n=e.map((function(e){return k(e)}));this.$emit("update:columns",n)},invokeUpdateColumns:function(e){this.emitUpdate(e,"invokeUpdateColumns")},invokeAdd:function(){var e={id:_(6)},t=this.columns.concat(e);this.emitUpdate(t,"invokeAdd")},invokeUpdate:function(e,t){var n=I(this.columns,"id",e,t);this.emitUpdate(n,"invokeUpdate")},invokeRemove:function(e){var t=this,n=function(){var n,i,r,o=(n=t.columns,i="id",r=e,Array.isArray(n)?n.filter((function(e){return e[i]!==r})):n);t.emitUpdate(o,"invokeRemove")},i=this.columns.findIndex((function(t){return t.id===e})),r=this.columns[i].name,o="確定刪除欄位 #".concat(i+1," [").concat(r||e,"] ?");this.handleConfirm?this.handleConfirm(o,n):confirm(o)&&n()},checkCollect:function(e,t){void 0===this.collect[e][t]&&this.$set(this.collect[e],t,null)},toggleCollect:function(e,t){this.checkCollect(e,t),this.collect[e][t]=!this.collect[e][t]},setCollect:function(e,t,n){this.checkCollect(e,t),this.collect[e][t]=n}}},F=w({render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",[e._t("default",null,{columns:e.columns,finalColumns:e.finalColumns,invokeUpdateColumns:e.invokeUpdateColumns,invokeAdd:e.invokeAdd,invokeUpdate:e.invokeUpdate,invokeRemove:e.invokeRemove})],2)},staticRenderFns:[]},undefined,A,undefined,false,undefined,!1,void 0,void 0,void 0),R={name:"Icon",props:{icon:{type:String,required:!0},isBtn:{type:Boolean,default:!1}},watch:{icon:"updateIcon"},mounted:function(){this.updateIcon(this.icon)},methods:{updateIcon:function(e){var t,n=this;return(t=regeneratorRuntime.mark((function t(){var i,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.$nextTick();case 2:n.$refs.el.textContent="",i=l.default.default?l.default.default:l.default,(r=e?i.renderSVG(e,{}):null)?n.$refs.el.appendChild(r):((o=document.createElement("span")).className="iconify",e&&(o.dataset.icon=e),n.$refs.el.appendChild(o));case 6:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function a(e){d(o,i,r,a,u,"next",e)}function u(e){d(o,i,r,a,u,"throw",e)}a(void 0)}))})()}}},j=R,T=w({render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("span",{ref:"el",staticClass:"icon",class:{"icon--btn":e.isBtn},on:{click:function(t){return t.preventDefault(),e.$emit("click")}}})},staticRenderFns:[]},undefined,j,undefined,false,undefined,!1,void 0,void 0,void 0),V={name:"FieldText",inheritAttrs:!1,props:{value:{type:String,default:null},size:{type:Number,default:null},maxlength:{type:Number,default:null}},emits:["input"],computed:{mutableValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}}},N=V,E=w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"input"},[n("input",e._b({directives:[{name:"model",rawName:"v-model.trim",value:e.mutableValue,expression:"mutableValue",modifiers:{trim:!0}}],attrs:{type:"text",maxlength:e.maxlength},domProps:{value:e.mutableValue},on:{input:function(t){t.target.composing||(e.mutableValue=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}},"input",e.$attrs,!1))])},staticRenderFns:[]},undefined,N,undefined,false,undefined,!1,void 0,void 0,void 0),q={name:"FieldNumber",inheritAttrs:!1,props:{value:{type:Number,default:null},min:{type:Number,default:null},max:{type:Number,default:null},step:{type:Number,default:null}},emits:["input"],computed:{mutableValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}}},B=q,K=w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"input"},[n("input",e._b({directives:[{name:"model",rawName:"v-model.number",value:e.mutableValue,expression:"mutableValue",modifiers:{number:!0}}],attrs:{type:"number",min:e.min,max:e.max,step:e.step},domProps:{value:e.mutableValue},on:{input:function(t){t.target.composing||(e.mutableValue=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}},"input",e.$attrs,!1))])},staticRenderFns:[]},undefined,B,undefined,false,undefined,!1,void 0,void 0,void 0),D={name:"FieldDate",inheritAttrs:!1,props:{value:{type:String,default:null},min:{type:String,default:null},max:{type:String,default:null}},emits:["input"],computed:{mutableValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}}},M=D,P=w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"input"},[n("input",e._b({directives:[{name:"model",rawName:"v-model.trim",value:e.mutableValue,expression:"mutableValue",modifiers:{trim:!0}}],attrs:{type:"date",min:e.min,max:e.max},domProps:{value:e.mutableValue},on:{input:function(t){t.target.composing||(e.mutableValue=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}},"input",e.$attrs,!1))])},staticRenderFns:[]},undefined,M,undefined,false,undefined,!1,void 0,void 0,void 0),L=w({render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"radio-row"},[e._t("default")],2)},staticRenderFns:[]},undefined,{name:"RadioRow"},undefined,false,undefined,!1,void 0,void 0,void 0),U=w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"field"},[n("field-"+e.type,e._b({tag:"component",scopedSlots:e._u([e._l(e.$scopedSlots,(function(t,n){return{key:n,fn:function(t){return[e._t(n,null,null,t)]}}}))],null,!0),model:{value:e.mutableValue,callback:function(t){e.mutableValue=t},expression:"mutableValue"}},"component",e.$attrs,!1))],1)},staticRenderFns:[]},undefined,{name:"Field",components:{FieldText:E,FieldNumber:K,FieldDate:P,FieldRadio:w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("RadioRow",e._l(e.options,(function(t){return n("label",{key:t[e.valueKey]},[n("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.mutableValue,expression:"mutableValue"}],attrs:{type:"radio"},domProps:{value:t[e.valueKey],checked:e._q(e.mutableValue,t[e.valueKey])},on:{change:function(n){e.mutableValue=t[e.valueKey]}}},"input",e.$attrs,!1)),e._v(" "),n("span",[e._v(e._s(t[e.textKey]))])])})),0)},staticRenderFns:[]},undefined,{name:"FieldRadio",components:{RadioRow:L},inheritAttrs:!1,props:{value:{type:[String,Number,Boolean],default:null},options:{type:Array,default:function(){return[]}},textKey:{type:String,default:"text"},valueKey:{type:String,default:"value"}},emits:["input"],computed:{mutableValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}}},undefined,false,undefined,!1,void 0,void 0,void 0),FieldCheckbox:w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("RadioRow",[n("label",[n("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.mutableValue,expression:"mutableValue"}],attrs:{type:"checkbox","true-value":e.yes,"false-value":e.no},domProps:{checked:Array.isArray(e.mutableValue)?e._i(e.mutableValue,null)>-1:e._q(e.mutableValue,e.yes)},on:{change:function(t){var n=e.mutableValue,i=t.target,r=i.checked?e.yes:e.no;if(Array.isArray(n)){var o=e._i(n,null);i.checked?o<0&&(e.mutableValue=n.concat([null])):o>-1&&(e.mutableValue=n.slice(0,o).concat(n.slice(o+1)))}else e.mutableValue=r}}},"input",e.$attrs,!1)),e._v(" "),n("span",[e._v(e._s(e.text))])])])},staticRenderFns:[]},undefined,{name:"FieldCheckbox",components:{RadioRow:L},inheritAttrs:!1,props:{value:{type:[String,Number,Boolean],default:null},yes:{type:[String,Number,Boolean],default:1},no:{type:[String,Number,Boolean],default:0},text:{type:String,default:"Yes"}},emits:["input"],computed:{mutableValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}}},undefined,false,undefined,!1,void 0,void 0,void 0),FieldCheckboxMulti:w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("RadioRow",e._l(e.options,(function(t){return n("label",{key:t[e.valueKey]},[n("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.mutableValue,expression:"mutableValue"}],attrs:{type:"checkbox",disabled:e.disabled||e.limit>-1&&e.value.length===e.limit&&!e.value.includes(t[e.valueKey])},domProps:{value:t[e.valueKey],checked:Array.isArray(e.mutableValue)?e._i(e.mutableValue,t[e.valueKey])>-1:e.mutableValue},on:{change:function(n){var i=e.mutableValue,r=n.target,o=!!r.checked;if(Array.isArray(i)){var a=t[e.valueKey],u=e._i(i,a);r.checked?u<0&&(e.mutableValue=i.concat([a])):u>-1&&(e.mutableValue=i.slice(0,u).concat(i.slice(u+1)))}else e.mutableValue=o}}},"input",e.$attrs,!1)),e._v(" "),n("span",[e._v(e._s(t[e.textKey]||"("+t[e.valueKey]+")"))])])})),0)},staticRenderFns:[]},undefined,{name:"FieldCheckboxMulti",components:{RadioRow:L},inheritAttrs:!1,props:{value:{type:Array,default:function(){return[]}},options:{type:Array,default:function(){return[]}},textKey:{type:String,default:"text"},valueKey:{type:String,default:"value"},disabled:{type:Boolean,default:!1},limit:{type:Number,default:-1}},emits:["input"],computed:{mutableValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}}},undefined,false,undefined,!1,void 0,void 0,void 0),FieldSelect:w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("VueSelect",{attrs:{value:e.mutableValue,options:e.mutableOptions,placeholder:e.placeholder,autocomplete:e.autocomplete,disabled:e.disabled,multiple:e.multiple,label:e.textKey,selectable:e.tempSelectable,reduce:e.tempReduce,"get-option-label":e.tempGetOptionLabel,"reset-on-options-change":e.resetOnOptionsChange,clearable:e.clearable,searchable:e.searchable,filterable:e.filterable,filter:e.fuseSearch,taggable:e.taggable,"push-tags":e.pushTags,"create-option":e.tempCreatedOption,"close-on-select":e.closeOnSelect,"no-drop":e.noDrop,"append-to-body":!0,"calculate-position":e.withPopper},on:{input:e.handleInput,"option:selected":e.optionSelected,"option:created":e.optionCreated},scopedSlots:e._u([e.required?{key:"search",fn:function(t){var i=t.attributes,r=t.events;return[n("input",e._g(e._b({staticClass:"vs__search",attrs:{required:!e.mutableValue}},"input",i,!1),r))]}}:null,{key:"selected-option",fn:function(t){return[n("h6",[e._v(e._s(t))]),e._v("\n    "+e._s(t[e.textKey]||"("+t[e.valueKey]+")")+"\n  ")]}},e.searchable?{key:"no-options",fn:function(t){var i=t.search;return[t.searching?[e._v("\n      查無\n      "),n("em",[e._v(e._s(i))]),e._v(" 相關.\n    ")]:n("em",{staticStyle:{opacity:"0.5"}},[e._v("開始嘗試搜尋欄位")])]}}:null,e._l(e.$scopedSlots,(function(t,n){return{key:n,fn:function(t){return[e._t(n,null,null,t)]}}}))],null,!0)})},staticRenderFns:[]},undefined,{name:"FieldSelect",components:{VueSelect:a.default},inheritAttrs:!1,props:{value:{type:[String,Number,Boolean,Array],default:null},options:{type:Array,default:function(){return[]}},placeholder:{type:String,default:""},autocomplete:{type:String,default:"off"},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},required:{type:Boolean,default:!1},textKey:{type:String,default:"text"},valueKey:{type:String,default:"value"},selectable:{type:Function,default:null},reduce:{type:Function,default:null},getOptionLabel:{type:Function,default:null},resetOnOptionsChange:{type:[Function,Boolean],default:!1},clearable:{type:Boolean,default:!1},searchable:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0},fuseKeys:{type:Array,default:function(){return["name"]}},taggable:{type:Boolean,default:!1},pushTags:{type:Boolean,default:!1},createOption:{type:Function,default:null},optionCreatedFlag:{type:Boolean,default:!1},closeOnSelect:{type:Boolean,default:!0},noDrop:{type:Boolean,default:!1}},emits:["input"],data:function(){return{placement:"bottom"}},computed:{mutableValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},mutableOptions:function(){return this.options},tempSelectable:function(){var e=this;return null!==this.selectable?this.selectable:this.multiple?function(t){return!(e.value||[]).includes(t[e.valueKey])}:function(){return!0}},tempReduce:function(){var e=this;return null!==this.reduce?this.reduce:function(t){return t[e.valueKey]}},tempGetOptionLabel:function(){var e=this;return null!==this.getOptionLabel?this.getOptionLabel:function(t){return t[e.textKey]||"(".concat(t[e.valueKey],")")}},tempCreatedOption:function(){var e=this;return null!==this.createOption?this.createOption:function(t){var n,i=(p(n={},e.valueKey,_(6)),p(n,e.textKey,t),n);return console.log("tempCreatedOption",i),i}},fuseSearch:function(){var e=this;return this.filterable&&this.searchable?function(t,n){var i=new u.default(t,{keys:e.fuseKeys,shouldSort:!0});return n.length?i.search(n).map((function(e){return e.item})):i.list}:null}},methods:{handleInput:function(e){console.log("handleInput",e),this.mutableValue=e},optionSelected:function(e){console.log("optionSelected",e)},optionCreated:function(e){console.log("optionCreated",e),this.optionCreatedFlag&&this.mutableOptions.push(e)},withPopper:function(e,t,i){var r=i.width;e.style.width=r;var o=n.createPopper(t.$refs.toggle,e,{placement:this.placement,modifiers:[{name:"offset",options:{offset:[0,-1]}},{name:"toggleClass",enabled:!0,phase:"write",fn:function(e){var n=e.state;t.$el.classList.toggle("drop-up","top"===n.placement)}}]});return function(){return o.destroy()}}}},undefined,false,undefined,!1,void 0,void 0,void 0),FieldFile:w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"input"},[n("input",e._b({attrs:{type:"file",multiple:e.multiple},on:{change:e.previewFiles}},"input",e.$attrs,!1))])},staticRenderFns:[]},undefined,{name:"FieldFile",inheritAttrs:!1,props:{value:{type:[Object,FileList],default:null},multiple:{type:Boolean,default:null}},emits:["input"],computed:{mutableValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},methods:{previewFiles:function(e){console.log(e.target.files),this.mutableValue=e.target.files}}},undefined,false,undefined,!1,void 0,void 0,void 0)},inheritAttrs:!1,props:{value:{type:[String,Number,Boolean,Array],default:null},default:{type:[String,Number,Boolean,Array],default:null},type:{type:String,default:"text",validator:function(e){return["text","number","date","radio","checkbox","checkbox-multi","select","file"].includes(e)}}},emits:["input"],computed:{mutableValue:{get:function(){return this.value},set:function(e){console.log("mutableValue",e),this.$emit("input",e)}}},created:function(){null!=this.default&&null==this.mutableValue&&(this.mutableValue=this.default)}},undefined,false,undefined,!1,void 0,void 0,void 0),H=w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"icon-row"},[e._t("default"),e._v(" "),n("Icon",{attrs:{icon:e.icon}})],2)},staticRenderFns:[]},undefined,{name:"IconRow",components:{Icon:T},props:{icon:{type:String,required:!0}}},undefined,false,undefined,!1,void 0,void 0,void 0),X=w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(e.$props.multiple?"div":"label",{tag:"component",class:["input-row",{required:e.required}]},[n("div",{staticClass:"for"},[e._t("label-left"),e._v(" "),n("p",[e._v(e._s(e.label))]),e._v(" "),e._t("label-right")],2),e._v(" "),n("Field",e._b({attrs:{multiple:e.multiple,required:e.required},on:{input:function(t){return e.$emit("input",t)}},scopedSlots:e._u([e._l(e.$scopedSlots,(function(t,n){return{key:n,fn:function(t){return[e._t(n,null,null,t)]}}}))],null,!0)},"Field",e.$attrs,!1))],1)},staticRenderFns:[]},undefined,{name:"InputRow",components:{Field:U},inheritAttrs:!1,props:{label:{type:String,default:""},required:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1}},emits:["input"]},undefined,false,undefined,!1,void 0,void 0,void 0),z=w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card"},[e.$slots.cardHeader||e.$scopedSlots.cardHeader?n("header",{staticClass:"card__header"},[e._t("cardHeader")],2):e._e(),e._v(" "),e.$slots.cardMain||e.$scopedSlots.cardMain?n("main",{staticClass:"card__main"},[e._t("cardMain")],2):e._e(),e._v(" "),e.$slots.cardFooter||e.$scopedSlots.cardFooter?n("footer",{staticClass:"card__footer"},[e._t("cardFooter")],2):e._e()])},staticRenderFns:[]},undefined,{name:"Card"},undefined,false,undefined,!1,void 0,void 0,void 0),G=w({render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"block",class:e.classes},[e._t("default")],2)},staticRenderFns:[]},undefined,{name:"Block",props:{shadow:{type:Boolean,required:!1},radius:{type:Boolean,required:!1}},computed:{classes:function(){return{"block--radius":this.radius,"block--shadow":this.shadow}}}},undefined,false,undefined,!1,void 0,void 0,void 0),J=w({render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("Draggable",{attrs:{tag:e.tag,handle:"."+e.handleClass,animation:e.animation,"ghost-class":e.ghostClass},model:{value:e.localValue,callback:function(t){e.localValue=t},expression:"localValue"}},[e._t("default")],2)},staticRenderFns:[]},undefined,{name:"CustomDraggable",components:{Draggable:s.default},props:{value:{type:Array,required:!0},handleClass:{type:String,default:"drag"},tag:{type:String,default:"div"},animation:{type:Number,default:200},ghostClass:{type:String,default:"ghost"}},emits:["input"],computed:{localValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}}},undefined,false,undefined,!1,void 0,void 0,void 0),Y=w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-setting"},[n("Draggable",{attrs:{value:e.columns},on:{input:e.invokeUpdateColumns}},e._l(e.columns,(function(t,i){return n("Block",{key:t.id,attrs:{radius:"",shadow:""}},[n("Card",{scopedSlots:e._u([{key:"cardHeader",fn:function(){return[e._t("cardHeader",[n("div",{staticClass:"drag"},[n("Icon",{attrs:{icon:"mdi:drag"}}),e._v(" "),n("span",[e._v("#"+e._s(i+1))])],1),e._v(" "),n("div",{staticClass:"card__name"},[e.collect[t.id].isEditName?[n("Field",{attrs:{placeholder:t.id},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"column.name"}})]:[n("div",{staticClass:"text-ellipsis"},[e._v(e._s(t.name||"("+t.id+")"))])],e._v(" "),n("Icon",{attrs:{icon:e.collect[t.id].isEditName?"ic:baseline-done-outline":"mi:edit-alt","is-btn":""},on:{click:function(n){return e.toggleIsEditName(t.id)}}})],2),e._v(" "),n("div",{staticClass:"card__controll"},[n("Icon",{attrs:{icon:e.collect[t.id].isOpen?"mdi:eye-minus":"mdi:eye-settings","is-btn":""},on:{click:function(n){return e.toggleIsOpen(t.id)}}}),e._v(" "),n("Icon",{attrs:{icon:"mdi:close-thick","is-btn":""},on:{click:function(n){return e.invokeRemove(t.id)}}})],1)],{idx:i,column:t,isOpen:e.collect[t.id].isOpen,toggleIsOpen:e.toggleIsOpen.bind(null,t.id),isEditName:e.collect[t.id].isEditName,toggleIsEditName:e.toggleIsEditName.bind(null,t.id)})]},proxy:!0},{key:"cardMain",fn:function(){return[e._t("cardMain",[n("ColumnSetting",e._b({directives:[{name:"show",rawName:"v-show",value:e.collect[t.id].isOpen,expression:"collect[column.id].isOpen"}],attrs:{idx:i,columns:e.columns},on:{update:e.invokeUpdate},scopedSlots:e._u([e._l(e.$scopedSlots,(function(t,n){return{key:n,fn:function(t){return[e._t(n,null,null,t)]}}}))],null,!0)},"ColumnSetting",t,!1))])]},proxy:!0}],null,!0)})],1)})),1),e._v(" "),n("button",{staticClass:"btn btn--add",on:{click:e.invokeAdd}},[e._v("✚")])],1)},staticRenderFns:[]},undefined,{name:"FormSetting",components:{Draggable:J,Block:G,Card:z,Icon:T,Field:U,ColumnSetting:w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"column-setting"},[n("InputRow",{attrs:{value:e.column.type,label:"欄位屬性",placeholder:"請選擇屬性",type:"select",options:e.typeOptions,required:""},on:{input:function(t){return e.updateColumn("type",t)}},scopedSlots:e._u([{key:"selected-option",fn:function(t){return[n("IconRow",{attrs:{icon:e.typeIcons[t.value]}},[e._v(e._s(t.text))])]}},{key:"option",fn:function(t){return[n("IconRow",{attrs:{icon:e.typeIcons[t.value]}},[e._v(e._s(t.text))])]}}])}),e._v(" "),n("nav",{staticClass:"tabs"},[e._l(e.tabOptions,(function(t){return[n("div",{directives:[{name:"show",rawName:"v-show",value:e.tabShow[t.value],expression:"tabShow[tab.value]"}],key:t.value,class:["tabs__item",{active:e.currentTab===t.value}]},[n("span",{on:{click:function(n){e.currentTab=t.value}}},[e._v(" "+e._s(t.text))])])]}))],2),e._v(" "),n("keep-alive",[n(e.currentCmp.component,e._b({directives:[{name:"show",rawName:"v-show",value:e.tabShow[e.currentTab],expression:"tabShow[currentTab]"}],tag:"component",on:{update:function(t){for(var n=arguments.length,i=Array(n);n--;)i[n]=arguments[n];return e.updateColumnTab.apply(void 0,[e.currentTab].concat(i))},updateObj:function(t){for(var n=arguments.length,i=Array(n);n--;)i[n]=arguments[n];return e.updateColumnTabObj.apply(void 0,[e.currentTab].concat(i))},addArr:function(t){for(var n=arguments.length,i=Array(n);n--;)i[n]=arguments[n];return e.addColumnTabArr.apply(void 0,[e.currentTab].concat(i))},updateArr:function(t){for(var n=arguments.length,i=Array(n);n--;)i[n]=arguments[n];return e.updateColumnTabArr.apply(void 0,[e.currentTab].concat(i))},removeArr:function(t){for(var n=arguments.length,i=Array(n);n--;)i[n]=arguments[n];return e.removeColumnTabArr.apply(void 0,[e.currentTab].concat(i))}},scopedSlots:e._u([e._l(e.$scopedSlots,(function(t,n){return{key:n,fn:function(t){return[e._t(n,null,null,t)]}}}))],null,!0)},"component",e.currentCmp.props,!1))],1)],1)},staticRenderFns:[]},undefined,{name:"ColumnSetting",components:{InputRow:X,IconRow:H,SettingBase:w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("fieldset",e._l(e.fields,(function(t,i){return n("InputRow",e._b({key:i,attrs:{value:e.$props[i]},on:{input:function(t){return e.$emit("update",i,t)}},scopedSlots:e._u([e._l(e.$scopedSlots,(function(t,n){return{key:n,fn:function(t){return[e._t(n,null,null,t)]}}}))],null,!0)},"InputRow",t.props,!1))})),1)},staticRenderFns:[]},undefined,{name:"ColumnSettingBase",components:{InputRow:X},inject:["convertOptions"],props:{id:{type:String,required:!0},typeConstraint:{type:Object,required:!0},columnsObjByKey:{type:Object,required:!0},label:{type:String,default:null},subLabel:{type:String,default:null},defaultValue:{type:[String,Number,Boolean,Array],default:null},placeholder:{type:String,default:null},encrypt:{type:Number,default:null},subType:{type:String,default:null}},emits:["update"],computed:{fields:function(){var e={label:{props:{label:"欄位說明"}},subLabel:{props:{label:"欄位子說明"}}};if(this.typeConstraint.isFile||(e.defaultValue={props:{label:"預設值"}}),this.typeConstraint.isInput&&(e.placeholder={props:{label:"提示文字"}}),this.typeConstraint.isText)e.subType={props:{label:"欄位性質",placeholder:"預設: 文字",type:"select",options:this.subTypeOptions,clearable:!0}};else if(this.typeConstraint.isNumber)e=m(m({},e),{},{defaultValue:{props:m(m({},e.defaultValue.props),{},{type:"number"})}});else if(this.typeConstraint.needItems){var t;e=m(m({},e),{},{defaultValue:{props:m(m({},e.defaultValue.props),{},{type:"select",placeholder:"請選擇",options:null===(t=this.columnsObjByKey[this.id].data)||void 0===t?void 0:t.items,searchable:!0,valueKey:"id",textKey:"text",fuseKeys:["text"],taggable:!0,pushTags:!0,optionCreatedFlag:!0,getOptionLabel:function(e){return e}})}})}return this.typeConstraint.isInput&&(e.encrypt={props:{label:"資料庫加密",type:"checkbox",text:"加密",yes:1,no:null}}),e},subTypeOptions:function(){return this.convertOptions({tel:"手機",email:"信箱",password:"密碼"})},autocompleteOptions:function(){return this.convertOptions({name:"全名",email:"信箱",username:"帳號","current-password":"密碼"})}}},undefined,false,undefined,!1,void 0,void 0,void 0),SettingData:w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("fieldset",[n("InputRow",{attrs:{value:e.$props.srcMode,label:"資料來源",placeholder:"請選擇來源",type:"select",options:e.sourceModeOptions,required:""},on:{input:function(t){return e.update("srcMode",t)}}}),e._v(" "),n("hr",{staticClass:"dashed"}),e._v(" "),"list"===e.$props.srcMode?[n("Block",{directives:[{name:"show",rawName:"v-show",value:e.$props.items.length,expression:"$props.items.length"}]},[n("Draggable",{attrs:{value:e.$props.items},on:{input:function(t){return e.update("items",t)}}},e._l(e.$props.items,(function(t,i){return n("div",{key:t.id,staticClass:"input-row"},[n("div",{staticClass:"drag"},[n("Icon",{attrs:{icon:"mdi:drag"}}),e._v(e._s(i+1))],1),e._v(" "),n("Field",{attrs:{value:t.text,placeholder:"("+t.id+")"},on:{input:function(n){return e.updateItem(t.id,"text",n)}}}),e._v(" "),n("Icon",{attrs:{icon:"mdi:close-thick","is-btn":""},on:{click:function(n){return e.removeItem(t.id)}}})],1)})),0)],1),e._v(" "),n("button",{staticClass:"btn btn--add",on:{click:function(t){return t.preventDefault(),e.addItem(t)}}},[e._v("✚")])]:[n("InputRow",{attrs:{value:e.$props.api.url,label:"API URL",required:""},on:{input:function(t){return e.updateApi("url",t)}}}),e._v(" "),n("InputRow",{attrs:{value:e.$props.api.textKey,label:"Value Key",required:""},on:{input:function(t){return e.updateApi("textKey",t)}}}),e._v(" "),n("InputRow",{attrs:{value:e.$props.api.valueKey,label:"Text Key",required:""},on:{input:function(t){return e.updateApi("valueKey",t)}}})]],2)},staticRenderFns:[]},undefined,{name:"ColumnSettingData",components:{InputRow:X,Icon:T,Field:U,Block:G,Draggable:J},inject:["handleConfirm","convertOptions"],props:{columnsExcludeSelf:{type:Array,required:!0},columnsObjByKey:{type:Object,required:!0},srcMode:{type:String,default:"list",validator:function(e){return["list","api"].includes(e)}},displayMode:{type:String,default:"line",validator:function(e){return["line","next","bothSide"].includes(e)}},items:{type:Array,default:function(){return[]}},api:{type:Object,default:function(){return{url:"",textKey:"",valueKey:""}}}},emits:["update","updateObj","updateArr","addArr","removeArr"],computed:{sourceModeOptions:function(){return this.convertOptions({list:"手動設置",api:"API"})},displayModeOptions:function(){return this.convertOptions({line:"Line by Line",next:"Next to each others",bothSide:"Stay on each sides in a row (Left - Right)"})}},methods:{update:function(e,t){this.$emit("update",e,t)},updateApi:function(e,t){this.$emit("updateObj","api",e,t)},updateItem:function(e,t,n){this.$emit("updateArr","items",e,t,n)},addItem:function(){this.$emit("addArr","items",{id:_(6),text:""})},removeItem:function(e){var t=this,n=function(){t.$emit("removeArr","items",e)},i=this.$props.items.findIndex((function(t){return t.id===e})),r=this.$props.items[i].text,o="確定刪除項目 #".concat(i+1," [").concat(r||e,"] ?");this.handleConfirm?this.handleConfirm(o,n):confirm(o)&&n()}}},undefined,false,undefined,!1,void 0,void 0,void 0),SettingRule:w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("fieldset",e._l(e.fields,(function(t,i){return n("div",{key:i,staticClass:"input-group"},[n("InputRow",e._b({attrs:{value:e.$props[i]},on:{input:function(t){return e.update(i,t)}},scopedSlots:e._u([{key:"label-right",fn:function(){return[n("Icon",{directives:[{name:"show",rawName:"v-show",value:e.$props[i],expression:"$props[k]"}],attrs:{icon:"mdi:ideogram-cjk-variant","is-btn":""},on:{click:function(t){return e.setToggleMsg(i)}}})]},proxy:!0},e._l(e.$scopedSlots,(function(t,n){return{key:n,fn:function(t){return[e._t(n,null,null,t)]}}}))],null,!0)},"InputRow",t.props,!1)),e._v(" "),n("InputRow",{directives:[{name:"show",rawName:"v-show",value:e.$props[i]&&e.toggleMsg[i],expression:"$props[k] && toggleMsg[k]"}],attrs:{value:e.$props.msg[i],placeholder:t.msg},on:{input:function(t){return e.$emit("updateObj","msg",i,t)}}})],1)})),0)},staticRenderFns:[]},undefined,{name:"ColumnSettingRule",components:{InputRow:X,Icon:T},inject:["collect","setCollect"],props:{id:{type:String,required:!0},name:{type:String,required:!0},typeConstraint:{type:Object,required:!0},columnsExcludeSelf:{type:Array,required:!0},columnsObjByKey:{type:Object,required:!0},msg:{type:Object,default:function(){return{}}},required:{type:Number,default:null},sameAs:{type:String,default:null},minimum:{type:Number,default:null},maximum:{type:Number,default:null},regex:{type:String,default:null},least:{type:Number,default:null},most:{type:Number,default:null}},emits:["update","updateObj"],computed:{fields:function(){var e=this.name||this.id,t=this.sameAs?this.columnsObjByKey[this.sameAs].name||this.columnsObjByKey[this.sameAs].id:"",n={required:{props:{label:"是否必填",text:"必填",type:"checkbox",yes:1,no:null},msg:"[".concat(e,"] 為必填。")},sameAs:{props:{label:"與..相符",placeholder:"請選擇欄位",type:"select",options:this.typeConstraint.filterSame(this.columnsExcludeSelf),valueKey:"id",textKey:"name",clearable:!0,searchable:!0},msg:"[".concat(e,"] 與 [").concat(t,"] 不相符")}};return this.typeConstraint.isText?n=m(m({},n),{},{minimum:{props:{label:"字元下限",type:"number"},msg:"[".concat(e,"] 最少 [:min] 個字。")},maximum:{props:{label:"字元上限",type:"number"},msg:"[".concat(e,"] 最多 [:max] 個字。")},regex:{props:{label:"驗證格式"},msg:"[".concat(e,"] 格式驗證失敗。")}}):this.typeConstraint.isNumber?n=m(m({},n),{},{minimum:{props:{label:"數字下限",type:"number"},msg:"[".concat(e,"] 最少 [:min]。")},maximum:{props:{label:"數字上限",type:"number"},msg:"[".concat(e,"] 最多 [:max]。")}}):this.typeConstraint.isCheckbox&&(n=m(m({},n),{},{least:{props:{label:"選擇數量下限",type:"number"},msg:"[".concat(e,"] 最少選 [:least] 個。")},most:{props:{label:"選擇數量上限",type:"number"},msg:"[".concat(e,"] 最多選 [:most] 個。")}})),n},toggleMsg:function(){return this.collect[this.id].toggleMsg}},created:function(){this.setCollect(this.id,"toggleMsg",{})},methods:{update:function(e,t){this.$emit("update",e,t),void 0===this.toggleMsg[e]&&this.setToggleMsg(e,!1)},setToggleMsg:function(e,t){this.setCollect(this.id,"toggleMsg",m(m({},this.toggleMsg),{},p({},e,void 0!==t?t:!this.toggleMsg[e])))}}},undefined,false,undefined,!1,void 0,void 0,void 0),SettingCondition:w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("fieldset",[n("InputRow",{attrs:{value:e.$props.requiredSync,label:"連動必填",type:"select",options:e.columnsExcludeSelf,"value-key":"id","text-key":"name",multiple:"",searchable:""},on:{input:function(t){return e.$emit("update","requiredSync",t)}}}),e._v(" "),e.requiredCheck.length?n("InputRow",{attrs:{value:e.requiredCheck,label:"被連動必填",type:"select",options:e.columnsExcludeSelf,"value-key":"id","text-key":"name",multiple:"",searchable:"","no-drop":"",disabled:""}}):e._e(),e._v(" "),n("hr",{staticClass:"dashed"}),e._v(" "),e._m(0),e._v(" "),e._l(e.$props.display,(function(t,i){return n("ConditionDisplay",e._b({key:t.id,attrs:{idx:i,"columns-exclude-self":e.columnsExcludeSelf,"columns-obj-by-key":e.columnsObjByKey},on:{update:function(n){for(var i=arguments.length,r=Array(i);i--;)r[i]=arguments[i];return e.updateDisplay.apply(void 0,[t.id].concat(r))},remove:function(n){return e.removeDisplay(t.id)}}},"ConditionDisplay",t,!1))})),e._v(" "),n("button",{staticClass:"btn btn--add",on:{click:function(t){return t.preventDefault(),e.addDisplay(t)}}},[e._v("✚")])],2)},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("顯示條件 "),n("em",{staticStyle:{opacity:"0.5"}},[e._v("(預設符合其一)")])])}]},undefined,{name:"ColumnSettingCondition",components:{InputRow:X,ConditionDisplay:w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Block",[n("InputRow",{attrs:{value:e.triggerID,label:"監聽欄位",type:"select",options:e.columnsExcludeSelf,"value-key":"id","text-key":"name",clearable:"",searchable:""},on:{input:function(t){return e.$emit("update","triggerID",t)}},scopedSlots:e._u([{key:"label-left",fn:function(){return[n("Icon",{attrs:{icon:"mdi:close-thick","is-btn":""},on:{click:function(t){return e.$emit("remove")}}}),e._v(" "),n("span",[e._v(e._s(e.idx+1)+". ")])]},proxy:!0},{key:"selected-option",fn:function(t){return[n("IconRow",{attrs:{icon:e.typeIcons[t.type]}},[e._v(e._s(t.name||"("+t.id+")"))])]}},{key:"option",fn:function(t){return[n("IconRow",{attrs:{icon:e.typeIcons[t.type]}},[e._v(e._s(t.name||"("+t.id+")"))])]}}])}),e._v(" "),e.triggerColumn?n("div",[n("Block",[n("div",{staticClass:"input-row"},["text"===e.triggerColumn.type?[n("div",{staticClass:"for"}),e._v(" "),n("Field",{attrs:{value:e.values,type:"select",multiple:"",taggable:"",searchable:"",placeholder:"請輸入條件，按下 Enter 確認。 (可輸入多筆)","no-drop":"","close-on-select":!1,reduce:function(e){return e},"get-option-label":function(e){return e},"create-option":function(e){return e}},on:{input:function(t){return e.$emit("update","values",t)}}})]:"number"===e.triggerColumn.type?[n("div",{staticClass:"for"},[e._v("符合其一")]),e._v(" "),n("Field",{attrs:{value:e.values,type:"select",multiple:"",taggable:"",searchable:"",placeholder:"請輸入條件，按下 Enter 確認。 (可輸入多筆)","no-drop":"","close-on-select":!1,reduce:function(e){return e},"get-option-label":e.thousandSeparatorFunc,"create-option":function(e){return Number(e)}},on:{input:function(t){return e.$emit("update","values",t)}}})]:["select","radio","checkbox"].includes(e.triggerColumn.type)&&e.triggerColumn.data?[n("div",{staticClass:"for"},[n("Field",{attrs:{value:e.meet,type:"select",options:e.meetOptions},on:{input:function(t){return e.$emit("update","meet",t)}}})],1),e._v(" "),"list"===e.triggerColumn.data.srcMode?n("Field",{attrs:{value:e.values,placeholder:"請選擇條件 (可多選)",type:"select",multiple:"",searchable:"",options:e.triggerColumn.data.items,"value-key":"id","text-key":"text","fuse-keys":["text"]},on:{input:function(t){return e.$emit("update","values",t)}}}):e._e()]:e._e()],2)])],1):e._e()],1)},staticRenderFns:[]},undefined,{name:"ColumnSettingConditionDisplay",components:{InputRow:X,Icon:T,Field:U,IconRow:H,Block:G},inject:["handleConfirm","typeIcons"],props:{columnsExcludeSelf:{type:Array,required:!0},columnsObjByKey:{type:Object,required:!0},idx:{type:Number,required:!0},triggerID:{type:String,default:null},values:{type:Array,default:function(){return[]}},meet:{type:Number,default:null}},emits:["update"],computed:{meetOptions:function(){return[{value:null,text:"符合其一"},{value:1,text:"符合全部"}]},triggerColumn:function(){return this.triggerID?this.columnsObjByKey[this.triggerID]:null},thousandSeparatorFunc:function(){return function(e){return function(e){if(!e)return e;var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}(e)}}}},undefined,false,undefined,!1,void 0,void 0,void 0)},inject:["handleConfirm"],props:{id:{type:String,required:!0},name:{type:String,default:"(no name)"},typeConstraint:{type:Object,required:!0},columnsExcludeSelf:{type:Array,required:!0},columnsObjByKey:{type:Object,required:!0},requiredSync:{type:Array,default:function(){return[]}},display:{type:Array,default:function(){return[]}}},emits:["update","updateObj","updateArr","addArr","removeArr"],computed:{requiredCheck:function(){var e=this,t=[];return this.columnsExcludeSelf.forEach((function(n){var i,r;null!==(i=n.condition)&&void 0!==i&&null!==(r=i.requiredSync)&&void 0!==r&&r.includes(e.id)&&t.push(n.id)})),t}},methods:{addDisplay:function(){this.$emit("addArr","display",{id:_(6)})},updateDisplay:function(e,t,n){this.$emit("updateArr","display",e,t,n)},removeDisplay:function(e){var t=this,n=function(){t.$emit("removeArr","display",e)},i=this.$props.display.findIndex((function(t){return t.id===e})),r="確定刪除顯示條件 #".concat(i+1,"?");this.handleConfirm?this.handleConfirm(r,n):confirm(r)&&n()}}},undefined,false,undefined,!1,void 0,void 0,void 0)},inject:["typeOptions","typeIcons","getTypeConstraint","convertOptions"],props:{idx:{type:Number,required:!0},columns:{type:Array,required:!0},id:{type:String,required:!0},name:{type:String,default:""},type:{type:String,default:""},base:{type:Object,default:function(){return{}}},rule:{type:Object,default:function(){return{}}},data:{type:Object,default:function(){return{}}},condition:{type:Object,default:function(){return{}}}},emits:["update"],data:function(){return{currentTab:"base"}},computed:{column:function(){return{id:this.id,name:this.name,type:this.type,base:this.base,rule:this.rule,data:this.data,condition:this.condition}},tabOptions:function(){return this.convertOptions({base:"基本",rule:"規則",data:"項目",condition:"條件"})},tabShow:function(){return{base:!0,rule:!0,data:this.typeConstraint.needItems,condition:!0}},currentCmp:function(){return{component:"setting-".concat(this.currentTab),props:m({id:this.column.id,name:this.column.name,typeConstraint:this.typeConstraint,columnsExcludeSelf:this.columnsExcludeSelf,columnsObjByKey:this.columnsObjByKey},this.column[this.currentTab])}},typeConstraint:function(){return this.getTypeConstraint(this.type)},columnsExcludeSelf:function(){var e=this;return this.columns.filter((function(t){return t.id!==e.id}))},columnsObjByKey:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id";return e.reduce((function(e,n){var i=n[t];return i?(e[i]=e[i]?m(m({},e[i]),n):n,e):e}),{})}(this.columns,"id")}},watch:{type:function(){this.resetBaseDefaultValue(),this.typeConstraint.needItems&&this.initSettingData()},"data.items":function(e,t){if((null==e?void 0:e.length)<(null==t?void 0:t.length)||!e&&t){var n=$(t,e||[])[0];this.resetBaseDefaultValue(),this.columnsExcludeSelf.map((function(e){var t,i;null===(t=e.condition)||void 0===t||null===(i=t.display)||void 0===i||i.map((function(e){var t,i;e.values=(t=e.values,i=n.id,Array.isArray(t)?t.filter((function(e){return e!==i})):t)}))}))}}},methods:{updateColumn:function(e,t){console.log("updateColumn[".concat(e,"]"),t),this.column[e]=t,this.$emit("update",this.column.id,this.column)},updateColumnTab:function(e,t,n){console.log("updateColumnTab[".concat(e,"][").concat(t,"]"),n);var i=m(m({},this.column[e]),{},p({},t,n));this.updateColumn(e,i)},updateColumnTabObj:function(e,t,n,i){console.log("updateColumnTabObj[".concat(e,"][").concat(t,"][").concat(n,"]"),i);var r=m(m({},this.column[e][t]),{},p({},n,i));this.updateColumnTab(e,t,r)},addColumnTabArr:function(e,t,n){console.log("addColumnTabArr[".concat(e,"][").concat(t,"]"),n);var i=this.column[e][t],r=i?[].concat(y(i),[n]):[n];this.updateColumnTab(e,t,r)},updateColumnTabArr:function(e,t,n,i,r){console.log("updateColumnTabArr[".concat(e,"][").concat(t,"][").concat(n,"][").concat(i,"]"),r);var o=I(this.column[e][t],"id",n,p({},i,r));this.updateColumnTab(e,t,o)},removeColumnTabArr:function(e,t,n){console.log("removeColumnTabArr[".concat(e,"][").concat(t,"]"),n);var i=O(this.column[e][t],"id",n);this.updateColumnTab(e,t,i)},initSettingData:function(){this.column.data.srcMode||(console.log("initSettingData()"),this.updateColumn("data",m(m({},this.column.data),{},{srcMode:"list",items:[]})))},resetBaseDefaultValue:function(){this.updateColumnTab("base","defaultValue",this.typeConstraint.isCheckbox?[]:null)}}},undefined,false,undefined,!1,void 0,void 0,void 0)},inject:["collect","toggleCollect"],props:{columns:{type:Array,required:!0},invokeUpdateColumns:{type:Function,required:!0},invokeAdd:{type:Function,required:!0},invokeUpdate:{type:Function,required:!0},invokeRemove:{type:Function,required:!0}},methods:{toggleIsOpen:function(e){this.toggleCollect(e,"isOpen")},toggleIsEditName:function(e){this.toggleCollect(e,"isEditName")}}},undefined,false,undefined,!1,void 0,void 0,void 0),Q=w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-demo"},[e._m(0),e._v(" "),n("code",[e._v("\n    "+e._s(e.columns)+"\n  ")])])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{attrs:{action:""}},[n("button",[e._v("Send")])])}]},undefined,{name:"FormDemo",props:{columns:{type:Array,required:!0}}},"data-v-ef04cf30",false,undefined,!1,void 0,void 0,void 0),W=w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"record-controls"},[n("button",{on:{click:e.addToRecord}},[n("Icon",{attrs:{icon:"mdi:content-save"}})],1),e._v(" "),n("button",{attrs:{disabled:!e.hasPrev},on:{click:e.restorePrev}},[n("Icon",{attrs:{icon:"ri:arrow-go-back-fill"}})],1),e._v(" "),n("button",{attrs:{disabled:!e.hasNext},on:{click:e.restoreNext}},[n("Icon",{attrs:{icon:"ri:arrow-go-forward-fill"}})],1),e._v(" "),n("button",{attrs:{disabled:!e.hasThis},on:{click:e.restoreThis}},[n("Icon",{attrs:{icon:"mdi:restore"}})],1),e._v(" "),n("button",{attrs:{disabled:!e.hasThis},on:{click:e.removeRecord}},[n("Icon",{attrs:{icon:"mdi:trash-can"}})],1),e._v(" "),e._t("default",[n("span",{directives:[{name:"show",rawName:"v-show",value:e.hasThis,expression:"hasThis"}]},[e._v(" "+e._s(e.recordIdx+1)+" / "+e._s(e.recordLimit)+" 筆 : "+e._s(e.createdTime)+" ")])],{hasThis:e.hasThis,recordIdx:e.recordIdx,recordLimit:e.recordLimit,createdTime:e.createdTime})],2)},staticRenderFns:[]},undefined,{name:"RecordControls",components:{Icon:T},props:{recordName:{type:String,required:!0},recordLimit:{type:Number,default:5},value:{type:[String,Number,Boolean,Array,Object,Date,Function,Symbol],required:!0},immediate:{type:Boolean,default:!1},callback:{type:Function,default:null}},data:function(){return{record:[],recordIdx:-1}},computed:{hasThis:function(){return this.recordIdx>-1&&this.recordIdx<this.record.length},hasPrev:function(){return this.recordIdx>0},hasNext:function(){return this.recordIdx<this.record.length-1},createdTime:function(){return this.record[this.recordIdx]&&this.record[this.recordIdx].created}},created:function(){this.getRecord()},methods:{removeRecord:function(){confirm("確定清除 [".concat(this.recordName,"] 的所有存檔?"))&&(localStorage.removeItem(this.recordName),window.location.reload())},getRecord:function(){this.record=JSON.parse(localStorage.getItem(this.recordName))||[],!this.immediate||this.record&&this.record.length||(this.record=[],this.addToRecord()),this.restoreLast()},addToRecord:function(){this.record.push({value:C(this.value),created:(new Date).toLocaleString()}),this.record.length>this.recordLimit&&(this.record=this.record.slice(0-this.recordLimit)),localStorage.setItem(this.recordName,JSON.stringify(this.record)),this.restoreLast()},restoreThis:function(){this.setTargetInfo(this.recordIdx)},restorePrev:function(){this.setTargetInfo(this.recordIdx-1)},restoreNext:function(){this.setTargetInfo(this.recordIdx+1)},restoreLast:function(){this.setTargetInfo(this.record.length-1)},setTargetInfo:function(e){var t=e>-1&&e<this.record.length?this.record[e].value:null;t&&(this.recordIdx=e,this.$emit("input",C(t)),this.callback&&this.callback(t))}}},undefined,false,undefined,!1,void 0,void 0,void 0),Z=w({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-builder"},[n("RecordControls",{attrs:{"record-name":"formBuilder-"+e.id,"record-limit":5,immediate:""},model:{value:e.localColumns,callback:function(t){e.localColumns=t},expression:"localColumns"}}),e._v(" "),n("h1",[e._v("Form ID: "+e._s(e.id))]),e._v(" "),n("FormMainLogic",{attrs:{columns:e.localColumns},on:{"update:columns":function(t){e.localColumns=t}},scopedSlots:e._u([{key:"default",fn:function(t){return[n("main",{staticClass:"form-builder__main"},[n("FormSetting",e._b({},"FormSetting",t,!1)),e._v(" "),n("FormDemo",{attrs:{columns:t.finalColumns}})],1)]}}])})],1)},staticRenderFns:[]},undefined,{name:"FormBuilder",components:{FormMainLogic:F,FormSetting:Y,FormDemo:Q,RecordControls:W},props:{id:{type:String,required:!0},columns:{type:Array,required:!0}},emits:["update:columns"],computed:{localColumns:{get:function(){return this.columns},set:function(e){this.$emit("update:columns",e)}}}},undefined,false,undefined,!1,void 0,void 0,void 0),ee=Object.freeze({__proto__:null,FormBuilder:Z,FormMainLogic:F,FormSetting:Y,FormDemo:Q,RecordControls:W}),te=function(e){Object.entries(ee).forEach((function(t){var n=h(t,2),i=n[0],r=n[1];e.component(i,r)}))},ne=Object.freeze({__proto__:null,default:te,FormBuilder:Z,FormMainLogic:F,FormSetting:Y,FormDemo:Q,RecordControls:W});return Object.entries(ne).forEach((function(e){var t=h(e,2),n=t[0],i=t[1];"default"!==n&&(te[n]=i)})),te}));