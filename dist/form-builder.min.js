/*!
 * @mk816017/form-builder v1.1.0 | MIT License | git+https://github.com/zhongyoulu/vue-sfc-rollup-demo.git
 * https://unpkg.com/@mk816017/form-builder@1.1.0/dist/form-builder.min.js
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("vuedraggable"),require("@iconify/iconify")):"function"==typeof define&&define.amd?define(["vuedraggable","@iconify/iconify"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).FormXXXBuilder=t(e.vuedraggable,e.Iconify)}(this,(function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=n(e),o=n(t);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t,n,r,o,i,a,s,c,l){"boolean"!=typeof a&&(c=s,s=a,a=!1);const u="function"==typeof n?n.options:n;let d;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,o&&(u.functional=!0)),r&&(u._scopeId=r),i?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,c(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},u._ssrRegister=d):t&&(d=a?function(e){t.call(this,l(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),d)if(u.functional){const e=u.render;u.render=function(t,n){return d.call(n),e(t,n)}}else{const e=u.beforeCreate;u.beforeCreate=e?[].concat(e,d):[d]}return n}var h=p({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-demo"},[e._m(0),e._v(" "),n("code",[e._v("\n    "+e._s(e.columns)+"\n  ")])])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{attrs:{action:""}},[n("button",[e._v("Send")])])}]},undefined,{name:"FormDemo",props:{id:{type:String,required:!0},columns:{type:Array,required:!0}}},"data-v-7a2f470a",false,undefined,!1,void 0,void 0,void 0);const b=o.default.default||o.default;JSON.parse("[]").forEach((e=>b.addCollection(e)));var v=p({render:function(){var e=this.$createElement;return(this._self._c||e)("span",{ref:"el",staticClass:"icon"})},staticRenderFns:[]},undefined,{name:"Icon",props:{icon:{type:String,required:!0}},watch:{icon:"updateIcon"},mounted:function(){this.updateIcon(this.icon)},methods:{updateIcon:function(e){var t,n=this;return(t=regeneratorRuntime.mark((function t(){var r,o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.$nextTick();case 2:n.$refs.el.textContent="",r=b.default?b.default:b,(o=e?r.renderSVG(e,{}):null)?n.$refs.el.appendChild(o):((i=document.createElement("span")).className="iconify",e&&(i.dataset.icon=e),n.$refs.el.appendChild(i));case 6:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(e){a(i,r,o,s,c,"next",e)}function c(e){a(i,r,o,s,c,"throw",e)}s(void 0)}))})()}}},undefined,false,undefined,!1,void 0,void 0,void 0);function y(){var e=Date.now();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}function g(e){return e&&"object"===i(e)?e instanceof Date?new Date(e.getTime()):e instanceof Array?e.reduce((function(e,t,n){return e[n]=g(t),e}),[]):e instanceof Object?Object.keys(e).reduce((function(t,n){return t[n]=g(e[n]),t}),{}):void 0:e}function x(e){return Object.entries(e).reduce((function(e,t){var n=u(t,2),r=n[0],o=n[1];return[].concat(d(e),[{value:r,text:o}])}),[])}var _=p({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card"},[n("header",{staticClass:"card__header"},[e._t("header",[n("div",{staticClass:"card__drag"},[n("Icon",{attrs:{icon:"mdi:drag"}}),e._v(" "),n("span",[e._v("#"+e._s(e.idx+1))])],1),e._v(" "),n("div",{staticClass:"text-ellipsis"},[e._v(e._s(e.mutableColumn.base.name?e.mutableColumn.base.name:"(請設定欄位名稱)"))]),e._v(" "),n("div",{staticClass:"controll"},[n("div",{staticClass:"icon-btn",on:{click:e.handleOpen}},[n("Icon",{attrs:{icon:e.isOpen?"mdi:eye-minus":"mdi:eye-settings"}})],1),e._v(" "),n("div",{staticClass:"icon-btn",on:{click:e.handleDelete}},[n("Icon",{attrs:{icon:"mdi:close-thick"}})],1)])],{handleOpen:e.handleOpen,isOpen:e.isOpen})],2),e._v(" "),n("form",{directives:[{name:"show",rawName:"v-show",value:e.isOpen,expression:"isOpen"}],staticClass:"card__form",attrs:{id:e.id}},[n("div",{staticClass:"border-top-dashed"},[n("ColumnSettingBase",e._b({on:{update:function(t){e.mutableColumn.base=t}}},"ColumnSettingBase",e.mutableColumn.base,!1))],1)])])},staticRenderFns:[]},undefined,{name:"ColumnSetting",components:{Icon:v,ColumnSettingBase:p({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"block block--option"},[n("fieldset",[n("legend",[e._v("基本設定")]),e._v(" "),n("Field",{attrs:{label:"欄位名稱","is-required":""},model:{value:e.sync.name,callback:function(t){e.$set(e.sync,"name",t)},expression:"sync.name"}}),e._v(" "),n("Field",{attrs:{label:"欄位屬性",type:"select",options:e.columnTypeOptions,placeholder:"請選擇屬性","is-required":""},model:{value:e.sync.type,callback:function(t){e.$set(e.sync,"type",t)},expression:"sync.type"}}),e._v(" "),n("Field",{attrs:{label:"欄位說明","is-required":""},model:{value:e.sync.label,callback:function(t){e.$set(e.sync,"label",t)},expression:"sync.label"}}),e._v(" "),n("Field",{attrs:{label:"欄位子說明"},model:{value:e.sync.subLabel,callback:function(t){e.$set(e.sync,"subLabel",t)},expression:"sync.subLabel"}}),e._v(" "),n("Field",{attrs:{label:"預設值"},model:{value:e.sync.defaultValue,callback:function(t){e.$set(e.sync,"defaultValue",t)},expression:"sync.defaultValue"}}),e._v(" "),n("Field",{attrs:{label:"提示文字"},model:{value:e.sync.placeholder,callback:function(t){e.$set(e.sync,"placeholder",t)},expression:"sync.placeholder"}})],1)])},staticRenderFns:[]},undefined,{name:"ColumnSettingBase",components:{Field:p({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("label",{class:["input-row",{required:e.isRequired}]},[n("div",{staticClass:"for"},[n("p",[e._v(e._s(e.label))])]),e._v(" "),n("div",{staticClass:"field"},[n("div",{staticClass:"input"},[n("input",e._b({domProps:{value:e.value},on:{input:e.update}},"input",e.$attrs,!1))])])])},staticRenderFns:[]},undefined,{inheritAttrs:!1,props:{label:{type:String,required:!0},value:{type:[String,Number],default:""},type:{type:String,default:"text",validator:function(e){return["text","number","select","select-search","radio","checkbox"].includes(e)}},isRequired:{type:Boolean,default:!1}},emits:["input"],computed:{isInput:function(){return["text","number"].includes(this.type)}},methods:{update:function(e){this.$emit("input",e.target.value)}}},undefined,false,undefined,!1,void 0,void 0,void 0)},props:{name:{type:String,default:null},label:{type:String,default:null},subLabel:{type:String,default:null},type:{type:String,default:null},placeholder:{type:String,default:null},defaultValue:{type:String,default:null},autocomplete:{type:String,default:null}},emits:["update"],data:function(){return{sync:{name:this.name,label:this.label,subLabel:this.subLabel,type:this.type,placeholder:this.placeholder,defaultValue:this.defaultValue,autocomplete:this.autocomplete}}},computed:{columnTypeOptions:function(){return x({text:"文字框 (text)",number:"數字框 (number)",select:"下拉選單 (select)",radio:"單選框 (radio)",checkbox:"勾選框 (checkbox)"})}},watch:{sync:{handler:function(e){var t=Object.entries(e).reduce((function(e,t){var n=u(t,2),r=n[0],o=n[1];return o&&(e[r]=o),e}),{});this.$emit("update",t)},deep:!0}}},undefined,false,undefined,!1,void 0,void 0,void 0)},props:{idx:{type:Number,required:!0},columns:{type:Array,required:!0},id:{type:String,required:!0},base:{type:Object,default:function(){return{}}}},emits:["update","delete"],data:function(){return{mutableColumn:{base:this.base},isOpen:!1,placement:"bottom"}},computed:{columnTypeOptions:function(){return x({text:"文字框 (text)",number:"數字框 (number)",select:"下拉選單 (select)",radio:"單選框 (radio)",checkbox:"勾選框 (checkbox)"})},sourceModeOptions:function(){return x({list:"手動設置",api:"API"})},displayModeOptions:function(){return x({line:"Line by Line",next:"Next to each others",bothSide:"Stay on each sides in a row (Left - Right)"})},isInput:function(){return["text","number"].includes(this.mutableColumn.base.type)},needItems:function(){return["select","radio","checkbox"].includes(this.mutableColumn.base.type)},columnsExcludeSelf:function(){var e=this.id;return this.columns.filter((function(t){return t.id!==e}))},columnsArr:function(){return e=this.columns,t="id",e?(t=t||"id",e.reduce((function(e,n){var r=n[t];return r&&(e[r]=Object.assign({},e[r],g(n))),e}),{})):{};var e,t}},watch:{mutableColumn:{handler:function(e){this.$emit("update",this.idx,l({id:this.id},e))},deep:!0}},methods:{handleDelete:function(){this.$emit("delete",this.idx)},handleOpen:function(){this.isOpen=!this.isOpen},addItem:function(){this.mutableColumn.data.items.push({id:y(),text:"",value:""})},deleteItem:function(e){this.mutableColumn.data.items.splice(e,1)}}},undefined,false,undefined,!1,void 0,void 0,void 0),C=p({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-setting"},[e._v("\n  "+e._s(e.mutableColumns)+"\n  "),n("Draggable",{attrs:{animation:"300","ghost-class":"ghost",handle:".card__drag"},model:{value:e.mutableColumns,callback:function(t){e.mutableColumns=t},expression:"mutableColumns"}},e._l(e.mutableColumns,(function(t,r){return n("ColumnSetting",e._b({key:t.id,attrs:{idx:r,columns:e.mutableColumns},on:{update:e.invokeUpdate,delete:e.invokeDelete}},"ColumnSetting",t,!1))})),1),e._v(" "),n("button",{staticClass:"btn btn--add",on:{click:e.handleAdd}},[e._v("✚")])],1)},staticRenderFns:[]},undefined,{name:"FormSetting",components:{Draggable:r.default,ColumnSetting:_},props:{columns:{type:Array,required:!0},handleDelete:{type:Function,default:null}},emits:["update"],data:function(){return{mutableColumns:[]}},watch:{mutableColumns:{handler:function(e){this.$emit("update",e)},deep:!0}},created:function(){var e=this;this.columns.forEach((function(t){e.mutableColumns.push(l({id:y()},t))}))},methods:{handleAdd:function(){this.mutableColumns.push({id:y()})},invokeUpdate:function(e,t){this.$set(this.mutableColumns,e,l({id:this.mutableColumns[e].id},t))},invokeDelete:function(e){var t=this,n=function(){t.mutableColumns.splice(e,1)};if(this.handleDelete)this.handleDelete(e,n);else{var r=this.mutableColumns[e],o="確定刪除欄位 #".concat(e+1," [").concat(r.base.name?r.base.name:r.id,"] ?");confirm(o)&&n()}},getColumnTemp:function(){return{id:y(),info:{name:"",label:"",subLabel:"",type:"",placeholder:null,defaultValue:null,autocomplete:null},rule:{required:null,minimum:null,maximum:null,regex:null,sameAs:null,limit:null},msg:{},conditions:[],requiredSync:[],requiredCheck:[],sameAsReverseCheck:[]}}}},undefined,false,undefined,!1,void 0,void 0,void 0),S=p({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"control-bar"},[n("button",{on:{click:e.addToRecord}},[n("Icon",{attrs:{icon:"mdi:content-save"}})],1),e._v(" "),n("button",{attrs:{disabled:!e.hasPrev},on:{click:e.restorePrev}},[n("Icon",{attrs:{icon:"ri:arrow-go-back-fill"}})],1),e._v(" "),n("button",{attrs:{disabled:!e.hasNext},on:{click:e.restoreNext}},[n("Icon",{attrs:{icon:"ri:arrow-go-forward-fill"}})],1),e._v(" "),n("button",{attrs:{disabled:!e.hasThis},on:{click:e.restoreThis}},[n("Icon",{attrs:{icon:"mdi:restore"}})],1),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.hasThis,expression:"hasThis"}]},[e._v("\n    "+e._s(e.recordIdx+1)+" / "+e._s(e.recordLimit)+" 筆 : "+e._s(e.record[e.recordIdx]&&e.record[e.recordIdx].created)+"\n  ")]),e._v(" "),n("div",[e._v("(localStorage 紀錄最後 "+e._s(e.recordLimit)+" 筆存檔)")])])},staticRenderFns:[]},undefined,{name:"RecordControls",components:{Icon:v},props:{recordName:{type:String,required:!0},recordLimit:{type:Number,default:5},data:{type:[String,Number,Boolean,Array,Object,Date,Function,Symbol],required:!0}},emits:["update"],data:function(){return{record:[],recordIdx:-1}},computed:{hasThis:function(){return this.recordIdx>-1&&this.recordIdx<this.record.length},hasPrev:function(){return this.recordIdx>0},hasNext:function(){return this.recordIdx<this.record.length-1}},created:function(){this.getRecord()},methods:{removeRecord:function(){localStorage.removeItem(this.recordName)},getRecord:function(){this.record=JSON.parse(localStorage.getItem(this.recordName))||[],this.restoreLast()},addToRecord:function(){this.record.push({created:(new Date).toLocaleString(),data:g(this.data)}),this.record.length>this.recordLimit&&(this.record=this.record.slice(0-this.recordLimit)),localStorage.setItem(this.recordName,JSON.stringify(this.record)),this.restoreLast()},restoreThis:function(){this.setTargetInfo(this.recordIdx)},restorePrev:function(){this.setTargetInfo(this.recordIdx-1)},restoreNext:function(){this.setTargetInfo(this.recordIdx+1)},restoreLast:function(){this.setTargetInfo(this.record.length-1)},setTargetInfo:function(e){var t=e>-1&&e<this.record.length?this.record[e].data:null;t&&(this.recordIdx=e,this.$emit("update",g(t)))}}},undefined,false,undefined,!1,void 0,void 0,void 0),O=Object.freeze({__proto__:null,FormDemo:h,FormSetting:C,RecordControls:S}),I=function(e){Object.entries(O).forEach((function(t){var n=u(t,2),r=n[0],o=n[1];e.component(r,o)}))},w=Object.freeze({__proto__:null,default:I,FormDemo:h,FormSetting:C,RecordControls:S});return Object.entries(w).forEach((function(e){var t=u(e,2),n=t[0],r=t[1];"default"!==n&&(I[n]=r)})),I}));